*** Settings ***
Resource    ${CURDIR}/../resources/config/env_setup.txt
Resource    ${CURDIR}/../resources/fixtures/fixture_and_faker.txt
Resource    ${CURDIR}/../resources/selenium_wrapper.txt

*** Test Cases ***
Submit Job From Edit Test Plan Page
    [Tags]      rat     submit
    Go To Edit Test Plan Page
    Open Directory     Utilities
    Open Directory     Samples
    Add Snippet     sleeptest
    Verify Snippet sleeptest Added In Test Layout Order 1
    Click Order 1 Snippet To Edit Ckeys
    Fillin Ckey seconds With Value 5
    Click Save In Ckey Window
    Verify Snippet In Order 1 Status Should Be "Ready to Submit"
    Click Add SUT In SUT Section
    Pick SUT    ${hw[0]['name']}
    Verify SUT Show Up In SUT Section Row 1 With Correct Data ${hw[0]}
    ${job id}=    Submit Job From Edit Test Plan Page
    Monitor Job ${job id} Status Should Be pass In 60 Seconds

#Two side selection for Robogalaxy and L2 Moonshot
Two side selection for Robogalaxy
    [Tags]      toft2
    Go To Edit Test Plan Page
    Open Directory     Test Harnesses
    Open Directory     RoboGalaxy
    Add Snippet     Basic job (registered server)
    Click Dropdown List Of Ckey robogalaxy_auto_server
    Select List Item "${hw[5]['name']}" From robogalaxy_auto_server
    Click Dropdown List Of Ckey robogalaxy_project
    Select List Item "rg_test" From robogalaxy_project
    Wait Until Fetch Completes
    Page Should Contain     /home/tenggo/rg_test/tests
    Page Should Contain     /home/tenggo/rg_test/tests/hello.txt
    Select Checkbox With Text   /home/tenggo/rg_test/tests
    Verify Checkbox With Text "/home/tenggo/rg_test/tests" Selected
    Verify Checkbox With Text "/home/tenggo/rg_test/tests/hello.txt" Not Selected
    Unselect Checkbox With Text   /home/tenggo/rg_test/tests
    Verify Checkbox With Text "/home/tenggo/rg_test/tests" Not Selected
    Verify Checkbox With Text "/home/tenggo/rg_test/tests/hello.txt" Not Selected
    ${selected layout}=    Get Data From JSON  ${CURDIR}/../testdata/test_2side_selection.json
    Select Checkbox With Text   /home/tenggo/rg_test/tests/hello.txt
    Add Selected Checkbox To Right Side
    Verify Option ${selected layout[0]} In Right Side 
    Verify Checkbox With Text "/home/tenggo/rg_test/tests/hello.txt" Selected
    Remove Selected Checkbox To Left Side
    Verify Option ${selected layout[1]} In Right Side 
    Verify Checkbox With Text "/home/tenggo/rg_test/tests/hello.txt" Not Selected
    Add All Checkboxes To Right Side
    Verify Option ${selected layout[2]} In Right Side 
    Verify Checkbox With Text "/home/tenggo/rg_test/tests" Selected
    Verify Checkbox With Text "/home/tenggo/rg_test/tests/hello.txt" Selected
    Remove All Checkboxes To Left Side
    Verify Option ${selected layout[3]} In Right Side 
    Verify Checkbox With Text "/home/tenggo/rg_test/tests" Not Selected
    Verify Checkbox With Text "/home/tenggo/rg_test/tests/hello.txt" Not Selected
    Click Check All Uncheck All
    Verify Checkbox With Text "/home/tenggo/rg_test/tests" Selected
    Verify Checkbox With Text "/home/tenggo/rg_test/tests/hello.txt" Selected
    Click Check All Uncheck All
    Verify Checkbox With Text "/home/tenggo/rg_test/tests" Not Selected
    Verify Checkbox With Text "/home/tenggo/rg_test/tests/hello.txt" Not Selected
    Click Save In Ckey Window
    Add Snippet     Basic job (registered server)
    Click Dropdown List Of Ckey robogalaxy_auto_server
    Select List Item "${hw[6]['name']}" From robogalaxy_auto_server
    Click Dropdown List Of Ckey robogalaxy_project
    Select List Item "winrg_test" From robogalaxy_project
    Wait Until Fetch Completes
    Page Should Contain     C: 
    Page Should Contain     Users
    Page Should Contain     Administrator
    Page Should Contain     RG
    Page Should Contain     winrg_test
    Page Should Contain     tests
    Page Should Contain     sample.txt
    Add All Checkboxes To Right Side
    Verify Option ${selected layout[4]} In Right Side 
    Click Save In Ckey Window
   # Open Directory  L2
   # Add Snippet     L2 Moonshot Helper
   # Click Dropdown List Of Ckey reg_l2a_server
   # Select List Item "${hw[7]['name']}" From reg_l2a_server
   # Wait Until Fetch Completes
   # Click Dropdown List Of Ckey program_web
   # Select List Item "Cirrus" From program_web
   # Wait Until Fetch Completes
   # Click Dropdown List Of Ckey l2_xml
   # Select List Item "cirrus001.xml" From l2_xml
   # Wait Until Fetch Completes
   # Click Force Refresh For Ckey testattr
   # Wait Until Fetch Completes
   # Click Dropdown List Of Ckey testattr
   # Select List Item "testAttributes_QA" From testattr
   # Wait Until Fetch Completes
   # Click Force Refresh For Ckey testattr
   # Wait Until Fetch Completes
   # Click Dropdown List Of Ckey reg_server
   # Select List Item "${hw[8]['name']}" From reg_server
   # Wait Until Fetch Completes
   # Page Should Contain     deployConfig_ai_rhel65.sh
   # Verify Option ${selected layout[5]} In Right Side 
   # Click Save In Ckey Window

Flow Control Pass
    [Tags]      toft2
    Upload QA Test Snippets
    Go To Edit Test Plan Page
    Open Directory  Utilities
    Open Directory  Samples
    Add Snippet     sleeptest
    Add Snippet     Sys-command on SUT
    Fillin Ckey command With Value ls
    Click Save In Ckey Window
    Add Snippet     sleeptest
    Open Directory  QA
    Add Snippet     hello_and_goodbye
    Change Pass Value To 4 For Order 2 Snippet
    Change Pass Value To _quit For Order 3 Snippet
    Change Pass Value To 3 For Order 4 Snippet
    Click Add SUT In SUT Section
    Pick SUT    ${hw[9]['name']}
    ${job id}=    Submit Job From Edit Test Plan Page
    Monitor Job ${job id} Status Should Be pass In 180 Seconds

Flow Control Fail
    [Tags]      toft2
    Upload QA Test Snippets
    Go To Edit Test Plan Page
    Open Directory  Utilities
    Add Snippet     Copy Files
    Fillin Ckey copy_src With Value not exist file
    Fillin Ckey copy_dst With Value not exist file
    Click Save In Ckey Window
    Add Snippet     Sys-command on SUT
    Fillin Ckey command With Value wrong command
    Click Save In Ckey Window
    Add Snippet     Copy Files
    Fillin Ckey copy_src With Value not exist file 2
    Fillin Ckey copy_dst With Value not exist file 2
    Click Save In Ckey Window
    Add Snippet     Sys-command on SUT
    Fillin Ckey command With Value wrong command 2
    Click Save In Ckey Window
    Change Fail Value To 4 For Order 2 Snippet
    Change Fail Value To _quit For Order 3 Snippet
    Change Fail Value To 3 For Order 4 Snippet
    Click Add SUT In SUT Section
    Pick SUT    ${hw[9]['name']}
    ${job id}=    Submit Job From Edit Test Plan Page
    Monitor Job ${job id} Status Should Be fail In 120 Seconds

Altair - Provisioning OS
    [Tags]      fast    altair
    Go To Edit Test Plan Page
    Open Directory  Provisioning
    Add Snippet     Altair OS Install
    Click Dropdown List Of Ckey altair_auto_server
    ${altair}=    Set Variable    ${hw[4]['name']}
    Select List Item "${altair}" From altair_auto_server
    Click Dropdown List Of Ckey os_build_plan
    Select List Item "ProLiant OS - RHEL 7.0 x64 Scripted Install" From os_build_plan
    Click Save In Ckey Window
    Verify Snippet Altair OS Install Added In Test Layout Order 1
    Verify Snippet In Order 1 Status Should Be "Ready to Submit"
    Click Add SUT In SUT Section
    Pick SUT    ${hw[1]['name']}
    Verify SUT Show Up In SUT Section Row 1 With Correct Data ${hw[1]}
    ${job id}=    Submit Job From Edit Test Plan Page
    Monitor Job ${job id} Status Should Be pass In 3000 Seconds

Robogalaxy
    [Tags]      fast    robogalaxy
    Go To Edit Test Plan Page
    Open Directory  Test Harnesses
    Open Directory  RoboGalaxy
    Add Snippet     Basic job (registered server)
    Click Dropdown List Of Ckey robogalaxy_auto_server
    Select List Item "${hw[5]['name']}" From robogalaxy_auto_server
    Click Dropdown List Of Ckey robogalaxy_project
    Select List Item "rg_test" From robogalaxy_project
    Wait Until Fetch Completes
    Page Should Contain     /home/tenggo/rg_test/tests/hello.txt
    Select Checkbox With Text   /home/tenggo/rg_test/tests/hello.txt
    Verify Checkbox With Text "/home/tenggo/rg_test/tests/hello.txt" Selected
    Add Selected Checkbox To Right Side
    ${selected layout}=    Get Data From JSON  ${CURDIR}/../testdata/test_2side_selection.json
    Verify Option ${selected layout[0]} In Right Side 
    Click Save In Ckey Window
    Verify Snippet Basic job (registered server) Added In Test Layout Order 1
    Verify Snippet In Order 1 Status Should Be "Ready to Submit"
    Add Snippet     Run job then copy logs (registered)
    Click Dropdown List Of Ckey robogalaxy_auto_server
    Select List Item "${hw[6]['name']}" From robogalaxy_auto_server
    Click Dropdown List Of Ckey robogalaxy_project
    Select List Item "winrg_test" From robogalaxy_project
    Wait Until Fetch Completes
    Click Dropdown List Of Ckey testcase
    Select List Item "\\sample.txt" From testcase
    Fillin Ckey log_repo With Value smb://devnfs:Compaq123@10.30.1.60/Public/QA/Auto_logs
    Click Save In Ckey Window
    Verify Snippet Run job then copy logs (registered) Added In Test Layout Order 2
    Verify Snippet In Order 2 Status Should Be "Ready to Submit"
    Click Not Required Checkbox
    ${job id}=    Submit Job From Edit Test Plan Page
    Monitor Job ${job id} Status Should Be pass In 300 Seconds

Job Group
    [Tags]      toft2   job group
    Go To Edit Test Plan Page
    Open Directory  Utilities
    Open Directory  Samples
    Add Snippet     sleeptest
    Verify Snippet sleeptest Added In Test Layout Order 1
    Click Order 1 Snippet To Edit Ckeys
    Fillin Ckey seconds With Value 60
    Click Save In Ckey Window
    Verify Snippet In Order 1 Status Should Be "Ready to Submit"
    Click Add SUT In SUT Section
    Pick SUT    ${hw[0]['name']}
    Verify SUT Show Up In SUT Section Row 1 With Correct Data ${hw[0]}
    Click Add SUT In SUT Section
    Pick SUT    ${hw[2]['name']}
    Verify SUT Show Up In SUT Section Row 2 With Correct Data ${hw[2]}
    Click Job Group Checkbox
    Verify Job Group Checkbox Selected
    ${job id}=    Submit Job From Edit Test Plan Page
    Go To Job Status Page
    Select Job  ${job id}
    Import Resource     ${CURDIR}/../resources/objects/cirrus_job_status.txt
    ${child job id 1}=    Get Table Cell     ${GROUP_JOBS_TABLE_IN_JOB_STATUS}  2   2
    log to console    Child Job ID:${child job id 1}
    ${child job id 2}=    Get Table Cell     ${GROUP_JOBS_TABLE_IN_JOB_STATUS}  3   2
    log to console    Child Job ID:${child job id 2}
    Run Keyword And Continue On Failure     Monitor Job ${child job id 1} Status Should Be pass In 120 seconds
    Run Keyword And Continue On Failure     Monitor Job ${child job id 2} Status Should Be pass In 30 seconds
    Run Keyword And Continue On Failure     Monitor Job ${job id} Status Should Be pass In 10 seconds

Skip all snippets
    [Tags]      fet
    Go To Edit Test Plan Page
    Open Directory  Utilities
    Open Directory  Samples
    Add Snippet     sleeptest
    Verify Snippet sleeptest Added In Test Layout Order 1    
    Verify Snippet In Order 1 Status Should Be "Ready to Submit"
    Add Snippet     sleeptest
    Verify Snippet sleeptest Added In Test Layout Order 2
    Verify Snippet In Order 2 Status Should Be "Ready to Submit" 
    Click Skip Checkbox Of Snippet Order 1 
    Verify Skip Checkbox Of Snippet Order 1 Selected
    Click Skip Checkbox Of Snippet Order 2
    Verify Skip Checkbox Of Snippet Order 2 Selected
    Click Add SUT In SUT Section
    Pick SUT    ${hw[0]['name']}
    Verify SUT Show Up In SUT Section Row 1 With Correct Data ${hw[0]}
    Submit Job From Edit Test Plan Page With Expected Error Message

Skip feature with checkbox
    [Tags]      fast
    Go To Edit Test Plan Page
    Open Directory  Utilities
    Open Directory  Samples
    Add Snippet     sleeptest
    Verify Snippet sleeptest Added In Test Layout Order 1
    Verify Snippet In Order 1 Status Should Be "Ready to Submit"
    Add Snippet     sleeptest
    Verify Snippet sleeptest Added In Test Layout Order 2
    Verify Snippet In Order 2 Status Should Be "Ready to Submit"
    Add Snippet     sleeptest
    Verify Snippet sleeptest Added In Test Layout Order 3
    Verify Snippet In Order 3 Status Should Be "Ready to Submit"
    Click Skip Checkbox Of Snippet Order 2
    Verify Skip Checkbox Of Snippet Order 2 Selected
    Click Add SUT In SUT Section
    Pick SUT    ${hw[0]['name']}
    Verify SUT Show Up In SUT Section Row 1 With Correct Data ${hw[0]}
    ${job id}=    Submit Job From Edit Test Plan Page
    Monitor Job ${job id} Status Should Be pass In 60 seconds

Altair - Provisioning SPP + CTRL + Reboot + System Command + Copyfiles
    [Tags]       toft2
    Upload QA Test Snippets
    Go To Edit Test Plan Page
    Open Directory  Provisioning
    Add Snippet     Altair SPP Install
    Click Dropdown List Of Ckey altair_auto_server
    ${altair}=    Set Variable    ${hw[4]['name']}
    Select List Item "${altair}" From altair_auto_server
    Click Dropdown List Of Ckey spp_bp
    Select List Item "ProLiant SW - Install Linux SPP" From spp_bp
    Click Save In Ckey Window
    Verify Snippet In Order 1 Status Should Be "Ready to Submit"
    Open Directory  QA
    Add Snippet     CTRL Linux
    Add Snippet     Reboot: agent_online False
   # Open Directory  Utilities
   # Add Snippet     Reboot
    Click Dropdown List Of Ckey rebootOSType
    Select List Item "lin" From rebootOSType
    Click Dropdown List Of Ckey rebootmode
    Select List Item "os" From rebootmode
    Click Dropdown List Of Ckey iloCommand
    Select List Item "Power off hard #### Power On" From iloCommand
    Click Save In Ckey Window
    Verify Snippet In Order 3 Status Should Be "Ready to Submit"
    Open Directory  Utilities
    Add Snippet     Sys-command on SUT
    Fillin Ckey command With Value ifconfig; ls -al
    Click Save In Ckey Window
    Verify Snippet In Order 4 Status Should Be "Ready to Submit"
    Add Snippet     Copy Files
    Fillin Ckey copy_src With Value ftp://devnfs:Compaq123@10.30.1.60/Public/QA/ctrl/*
    Fillin Ckey copy_dst With Value /ci/data/cirrus/copyfiles_d
    Click Save In Ckey Window
    Verify Snippet In Order 5 Status Should Be "Ready to Submit"
    Click Add SUT In SUT Section
    Pick SUT    ${hw[1]['name']}
    Verify SUT Show Up In SUT Section Row 1 With Correct Data ${hw[1]}
    ${job id}=    Submit Job From Edit Test Plan Page
    Monitor Job ${job id} Status Should Be pass In 1800 Seconds

Submit SJCF via Cirrus GUI
    [Tags]      fast    submit
    Upload QA Test Snippets
    Go To Edit Test Plan Page
    Open Directory  QA
    Add Snippet     sjcf_hello_world
    Verify Snippet sjcf_hello_world Added In Test Layout Order 1
    Verify Snippet In Order 1 Status Should Be "Ready to Submit"
    Click Add SUT In SUT Section
    Pick SUT    ${hw[9]['name']}
    Verify SUT Show Up In SUT Section Row 1 With Correct Data ${hw[9]}
    ${job id}=    Submit Job From Edit Test Plan Page
    Monitor Job ${job id} Status Should Be pass In 150 Seconds

Notify
    [Tags]      fast     notify
    Upload QA Test Snippets
    Go To Edit Test Plan Page
    Open Directory  QA
    Add Snippet     Notify
    Verify Snippet Notify Added In Test Layout Order 1
    Verify Snippet In Order 1 Status Should Be "Ready to Submit"
    Click Add SUT In SUT Section
    Pick SUT    ${hw[9]['name']}
    Verify SUT Show Up In SUT Section Row 1 With Correct Data ${hw[9]}
    ${job id}=    Submit Job From Edit Test Plan Page
    Monitor Job ${job id} Status Should Be pass In 180 Seconds

CTRL
    [Tags]      fast     ctrl
    Upload QA Test Snippets
    Go To Edit Test Plan Page
    Open Directory  QA
    Add Snippet     CTRL Linux
    Verify Snippet CTRL Linux Added In Test Layout Order 1
    Verify Snippet In Order 1 Status Should Be "None"
    Open Directory  Test Harnesses
    Open Directory  CTRL
    Add Snippet     Run CTRL
    Fillin Ckey control_file With Value /ctrl/cal.json
    Click Save In Ckey Window
    Verify Snippet In Order 2 Status Should Be "Ready to Submit"
    Click Add SUT In SUT Section
    Pick SUT    ${hw[9]['name']}
    Verify SUT Show Up In SUT Section Row 1 With Correct Data ${hw[9]}
    ${job id}=    Submit Job From Edit Test Plan Page
    Monitor Job ${job id} Status Should Be pass In 180 Seconds

MSI Install
    [Tags]      fast     msi
    Upload QA Test Snippets
    Go To Edit Test Plan Page
    Open Directory  QA
    Add Snippet     msi_install
    Verify Snippet msi_install Added In Test Layout Order 1
    Verify Snippet In Order 1 Status Should Be "None"
    Click Add SUT In SUT Section
    Pick SUT    ${hw[10]['name']}
    Verify SUT Show Up In SUT Section Row 1 With Correct Data ${hw[10]}
    ${job id}=    Submit Job From Edit Test Plan Page
    Monitor Job ${job id} Status Should Be pass In 180 Seconds

Copyfiles_ESXi
    [Tags]      fast     copyfiles
    Upload QA Test Snippets
    Go To Edit Test Plan Page
    Open Directory  QA
    Add Snippet     copyfiles_esxi
    Verify Snippet copyfiles_esxi Added In Test Layout Order 1
    Verify Snippet In Order 1 Status Should Be "None"
    Click Add SUT In SUT Section
    Pick SUT    ${hw[11]['name']}
    Verify SUT Show Up In SUT Section Row 1 With Correct Data ${hw[11]}
    ${job id}=    Submit Job From Edit Test Plan Page
    Monitor Job ${job id} Status Should Be pass In 180 Seconds

Copyfiles
    [Tags]      fast     copyfiles
    Upload QA Test Snippets
    Go To Edit Test Plan Page
    Open Directory  QA
    Add Snippet     copyfiles
    Verify Snippet copyfiles Added In Test Layout Order 1
    Verify Snippet In Order 1 Status Should Be "None"
    Open Directory  Utilities
    Add Snippet     Copy Files
    Fillin Ckey copy_src With Value ftp://devnfs:Compaq123@10.30.1.60/Public/QA/ovftool-410_userguide.pdf
    Fillin Ckey copy_dst With Value /tmp/cirrus_data
    Click Save In Ckey Window
    Verify Snippet In Order 2 Status Should Be "Ready to Submit"
    Click Add SUT In SUT Section
    Pick SUT    ${hw[9]['name']}
    Verify SUT Show Up In SUT Section Row 1 With Correct Data ${hw[9]}
    ${job id}=    Submit Job From Edit Test Plan Page
    Monitor Job ${job id} Status Should Be pass In 180 Seconds

Hello_and_goodbye
    [Tags]      fast     hello and goodbye
    Upload QA Test Snippets
    Go To Edit Test Plan Page
    Open Directory  QA
    Add Snippet     hello_and_goodbye
    Verify Snippet hello_and_goodbye Added In Test Layout Order 1
    Verify Snippet In Order 1 Status Should Be "None"
    Click Add SUT In SUT Section
    Pick SUT    ${hw[9]['name']}
    Verify SUT Show Up In SUT Section Row 1 With Correct Data ${hw[9]}
    ${job id}=    Submit Job From Edit Test Plan Page
    Monitor Job ${job id} Status Should Be pass In 120 Seconds

Reboot_os
    [Tags]      fast     reboot
    Go To Edit Test Plan Page
    Open Directory  Utilities
    Add Snippet     Reboot
    Click Dropdown List Of Ckey rebootOSType
    Select List Item "win" From rebootOSType
    Click Dropdown List Of Ckey rebootmode
    Select List Item "os" From rebootmode
    Click Save In Ckey Window
    Verify Snippet Reboot Added In Test Layout Order 1
    Verify Snippet In Order 1 Status Should Be "Ready to Submit"
    Click Add SUT In SUT Section
    Pick SUT    ${hw[10]['name']}
    Verify SUT Show Up In SUT Section Row 1 With Correct Data ${hw[10]}
    ${job id}=    Submit Job From Edit Test Plan Page
    Monitor Job ${job id} Status Should Be pass In 300 Seconds

Reboot_ilo
    [Tags]      fast     reboot
    Go To Edit Test Plan Page
    Open Directory  Utilities
    Add Snippet     Reboot
    Click Dropdown List Of Ckey rebootOSType
    Select List Item "lin" From rebootOSType
    Click Dropdown List Of Ckey rebootmode
    Select List Item "ilo" From rebootmode
    Click Dropdown List Of Ckey iloCommand
    Select List Item "Power off hard #### Power On" From iloCommand
    Click Save In Ckey Window
    Verify Snippet Reboot Added In Test Layout Order 1
    Verify Snippet In Order 1 Status Should Be "Ready to Submit"
    Click Add SUT In SUT Section
    Pick SUT    ${hw[1]['name']}
    Verify SUT Show Up In SUT Section Row 1 With Correct Data ${hw[1]}
    ${job id}=    Submit Job From Edit Test Plan Page
    Monitor Job ${job id} Status Should Be pass In 720 Seconds

System Command On SUT
    [Tags]      fast     sys_command
    Go To Edit Test Plan Page
    Open Directory  Utilities
    Add Snippet     Sys-command on SUT
    Fillin Ckey command With Value ls /tmp
    Click Save In Ckey Window
    Verify Snippet Sys-command on SUT Added In Test Layout Order 1
    Verify Snippet In Order 1 Status Should Be "Ready to Submit"
    Click Add SUT In SUT Section
    Pick SUT    ${hw[9]['name']}
    Verify SUT Show Up In SUT Section Row 1 With Correct Data ${hw[9]}
    ${job id}=    Submit Job From Edit Test Plan Page
    Monitor Job ${job id} Status Should Be pass In 240 Seconds

System Command On Remote System
    [Tags]      fast     sys_command
    Go To Edit Test Plan Page
    Open Directory  Utilities
    Add Snippet     Sys-command on remote system
    Fillin Ckey target_ip With Value ${hw[9]['sys_ip']}
    Fillin Ckey command With Value ls /tmp
    Fillin Ckey sys_username With Value ${hw[9]['sys_username']}
    Fillin Input Type Ckey sys_password With Value ${hw[9]['sys_password']}
    Click Save In Ckey Window
    Verify Snippet Sys-command on remote system Added In Test Layout Order 1
    Verify Snippet In Order 1 Status Should Be "Ready to Submit"
    Click Not Required Checkbox
    ${job id}=    Submit Job From Edit Test Plan Page
    Monitor Job ${job id} Status Should Be pass In 240 Seconds
