*** Settings ***
Resource        ${CURDIR}/../resources/init_settings.txt

Test Setup      Login To Appliance  ${VM_name}

Force Tags        rest


*** Keywords ***
Login To Appliance
    [Arguments]     ${VM_name}
    Import Library  ${CURDIR}/../resources/EsxiLib.py    ip=${VSPHERE_IP}    username=${VSPHERE_USERNAME}   password=${VSPHERE_PASSWORD}    WITH NAME   EsxiLib
    ${ip}=  Get Variable Value  ${CIRRUS_VM_IP}
    ${ip}=  Run Keyword If  '${ip}' == 'None'  EsxiLib.Get IP  vmname=${VM_name}  ELSE  Get Variable Value  ${ip}
    Import Library  ${CURDIR}/../resources/CirrusRESTLib.py    ip=${ip}    WITH NAME   Cirrus
    ${resp}=    Login Cirrus    ${CIRRUS_ADMIN_USERNAME}    ${CIRRUS_ADMIN_PASSWORD}
    Log to Console      ${ip}
    Should Be Equal As Strings    ${resp}    200

*** Test Cases ***
Export Hardware
    [Tags]  rat
    ${resp}=    Export Hardware    4 
    Should Be Equal As Strings    ${resp}    200

Import Hardware
    [Tags]  rat
    ${resp}=    Import Hardware    ${CURDIR}/../testdata/import_hw.json
    Should Be Equal As Strings    ${resp}    202

Export Test Plans
    [Tags]  rat
    ${resp}=    Export Testplan    testplan_sleep.json
    Should Be Equal As Strings    ${resp}    200

Import Test Plans
    [Tags]  rat
    ${resp}=    Import Testplan     ${CURDIR}/../testdata/export_testplan_2017-03-0310-36-31.zip
    Should Be Equal As Strings    ${resp}    201
